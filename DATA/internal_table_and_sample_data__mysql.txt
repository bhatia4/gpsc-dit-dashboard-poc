CREATE TABLE control_table (
	IN_RUN_NBR		MEDIUMINT NOT NULL,
	MASTER_ID		SMALLINT,
	SRC_FILE_NAME 		VARCHAR(100),
	SRC_REC_CNT		INT,	
	SEGMENT_NAME 		VARCHAR(10),
	PLANT			VARCHAR(4),
	REGION			VARCHAR(4),
	SEGMENT_FILE_NAME 	VARCHAR(100),	
	SEGMENT_REC_CNT		MEDIUMINT,
	BEFORE_FILE_NAME	VARCHAR(100),
	AFTER_FILE_NAME		VARCHAR(100),
	CREATED_DT		DATE,
	FILE_ARRIVED_DATE	DATE,
	FILE_PROCESS_STATE	VARCHAR(32),
	FILE_PROCESS_STATUS	VARCHAR(32), 
	DIFF_FILE_NAME		VARCHAR(100),
	ERROR_FILE_NAME		VARCHAR(100),
	UPDATED_DT		DATE,
	DIFF_FILE_CNT		SMALLINT,
	DIFF_INS_CNT		SMALLINT,
	DIFF_UPD_CNT		SMALLINT,
	DIFF_DEL_CNT		SMALLINT,
	DIFF_ERR_CNT		SMALLINT,
	CDC_UPDATED_DT		DATE,
	ODS_INS_CNT		SMALLINT,
	ODS_UPD_CNT		SMALLINT,
	ODS_DEL_CNT		SMALLINT,
	ODS_ERR_CNT		SMALLINT,
	INB_UPDATED_DT		DATE,
	DM_INS_CNT		SMALLINT,
	DM_UPD_CNT		SMALLINT,
	DM_DEL_CNT		SMALLINT,
	DM_ERR_CNT		SMALLINT,
	OUT_UPDATED_DT		DATE,
	RECON_FLAG		VARCHAR(16),
	RECON_ERR_MSG		VARCHAR(100),
	CDC_JOB_INSTANCE_ID	VARCHAR(100),
	INB_JOB_INSTANCE_ID	VARCHAR(100),
	OUT_JOB_INSTANCE_ID	VARCHAR(100),
	PRIMARY KEY (IN_RUN_NBR)
);



LOAD DATA INFILE 'C://Personal//WorkSpace//gpsc-dit-dashboard-poc//DATA//CTRL_TBL_Sample_Data.csv' INTO TABLE control_table
	FIELDS TERMINATED BY ',' 
	LINES TERMINATED BY '\r\n'
	IGNORE 1 LINES
(IN_RUN_NBR, MASTER_ID, SRC_FILE_NAME, SRC_REC_CNT, SEGMENT_NAME, PLANT, REGION, SEGMENT_FILE_NAME, SEGMENT_REC_CNT, BEFORE_FILE_NAME, AFTER_FILE_NAME, @CREATED_DT, @FILE_ARRIVED_DATE, FILE_PROCESS_STATE, FILE_PROCESS_STATUS, DIFF_FILE_NAME, ERROR_FILE_NAME, @UPDATED_DT, DIFF_FILE_CNT, DIFF_INS_CNT, DIFF_UPD_CNT, DIFF_DEL_CNT, DIFF_ERR_CNT, @CDC_UPDATED_DT, ODS_INS_CNT, ODS_UPD_CNT, ODS_DEL_CNT, ODS_ERR_CNT, @INB_UPDATED_DT, DM_INS_CNT, DM_UPD_CNT, DM_DEL_CNT, DM_ERR_CNT, @OUT_UPDATED_DT, RECON_FLAG, RECON_ERR_MSG, CDC_JOB_INSTANCE_ID, INB_JOB_INSTANCE_ID, OUT_JOB_INSTANCE_ID)
	SET CREATED_DT = STR_TO_DATE(@CREATED_DT, '%e-%b-%y'),
	FILE_ARRIVED_DATE = STR_TO_DATE(@FILE_ARRIVED_DATE, '%e-%b-%y'),
	UPDATED_DT = STR_TO_DATE(@UPDATED_DT, '%e-%b-%y'),
	CDC_UPDATED_DT = STR_TO_DATE(@CDC_UPDATED_DT, '%e-%b-%y'),
	INB_UPDATED_DT = STR_TO_DATE(@INB_UPDATED_DT, '%e-%b-%y'),
	OUT_UPDATED_DT = STR_TO_DATE(@OUT_UPDATED_DT, '%e-%b-%y');